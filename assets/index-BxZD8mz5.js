var p=Object.defineProperty;var f=(n,r,e)=>r in n?p(n,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[r]=e;var o=(n,r,e)=>f(n,typeof r!="symbol"?r+"":r,e);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const l of t)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(t){const l={};return t.integrity&&(l.integrity=t.integrity),t.referrerPolicy&&(l.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?l.credentials="include":t.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(t){if(t.ep)return;t.ep=!0;const l=e(t);fetch(t.href,l)}})();class h{static async fetchUrl(r){try{const e=await fetch(r);if(!e.ok)throw new Error(`HTTP error! status: ${e.status} at ${r}`);return await e.text()}catch(e){throw console.error(`[Utils.fetchUrl] Error fetching "${r}":`,e),e}}}class g{constructor(){o(this,"segments",[])}addSegment(r){const{initialLength:e,finalLength:s,initialElevation:t,finalElevation:l}=r,i=(s-e)*1e3,a=l-t,u=i!==0?a/i:0,c={id:this.segments.length+1,initialLength:e,finalLength:s,initialElevation:t,finalElevation:l,distance:i,desnivel:a,slope:u};this.segments.push(c)}getSegments(){return[...this.segments]}getTotalDesnivel(){return this.segments.reduce((r,e)=>r+e.desnivel,0)}getTotalDistance(){return this.segments.reduce((r,e)=>r+e.distance,0)}getAverageSlope(){const r=this.getTotalDistance();return r!==0?this.getTotalDesnivel()/r:0}clearSegments(){this.segments=[]}}class v extends HTMLElement{constructor(){super(...arguments);o(this,"submitHandler",e=>this.onSubmit(e));o(this,"clearFieldsHandler",()=>this.onClearFields());o(this,"clearAllHandler",()=>this.onClearAll())}async connectedCallback(){const e=await h.fetchUrl("/form.html");this.innerHTML=e;const s=this.querySelector("#form");Array.from(s.querySelectorAll("custom-input")).forEach(a=>{if(a.hasAttribute("required")&&(a.validator=c=>({valid:c.trim().length>0,message:"Este campo es obligatorio"})),a.getAttribute("data-validate")==="nonEmpty"){const c=a.getAttribute("data-error")||"No puede quedar vacío";a.validator=d=>({valid:d.trim()!=="",message:c})}}),s.addEventListener("submit",this.submitHandler),s.querySelector(".form-button-delete").addEventListener("click",this.clearFieldsHandler),s.querySelector("#deleteAll").addEventListener("click",this.clearAllHandler)}disconnectedCallback(){const e=this.querySelector("#form");if(e){e.removeEventListener("submit",this.submitHandler);const s=e.querySelector(".form-button-delete");s&&s.removeEventListener("click",this.clearFieldsHandler);const t=e.querySelector("#deleteAll");t&&t.removeEventListener("click",this.clearAllHandler)}}onSubmit(e){e.preventDefault();const s=this.querySelector("#form"),t=Array.from(s.querySelectorAll("custom-input"));let l=!0;if(t.forEach(d=>{d.validate()||(l=!1)}),!l){alert("No puede haber campos vacíos.");return}const[i,a,u,c]=t.map(d=>Number(d.value));this.dispatchEvent(new CustomEvent("segment-submitted",{bubbles:!0,composed:!0,detail:{initialLength:i,finalLength:a,initialElevation:u,finalElevation:c}})),this.clearFields()}onClearFields(){const e=this.querySelector("#form"),s=Array.from(e.querySelectorAll("custom-input"));this.clearFields(s)}clearFields(e){(e??Array.from(this.querySelector("#form").querySelectorAll("custom-input"))).forEach(t=>{var i;t.value="";const l=(i=t.shadowRoot)==null?void 0:i.querySelector("input");l&&(l.style.borderColor="#ccc")})}onClearAll(){this.clearFields(),this.dispatchEvent(new CustomEvent("clear-all",{bubbles:!0,composed:!0}))}}customElements.define("slope-form",v);class b extends HTMLElement{constructor(){super(...arguments);o(this,"tbody")}init(){this.innerHTML=`
      <div class="summary">
        <p><strong>Distancia total:</strong> <span class="total-dist">0.00 m</span></p>
        <p><strong>Desnivel total:</strong> <span class="total-desn">0.00 m</span></p>
        <p><strong>Pendiente media:</strong> <span class="avg-slope">0.00 %</span></p>
      </div>
      <table>
        <thead>
          <tr>
            <th>#</th><th>Dist.</th><th>Desn.</th><th>Pend.</th>
            <th>Long. ini</th><th>Long. fin</th><th>Alt. ini</th><th>Alt. fin</th>
          </tr>
        </thead>
        <tbody class="segments-body"></tbody>
      </table>
    `,this.tbody=this.querySelector(".segments-body")}addSegment(e){const s=e.getSegments(),t=s[s.length-1];if(!t)return;const l=document.createElement("tr");l.innerHTML=`
      <td>${t.id}</td>
      <td>${t.distance.toFixed(2)} m</td>
      <td>${t.desnivel.toFixed(2)} m</td>
      <td>${(t.slope*100).toFixed(2)}%</td>
      <td>${t.initialLength} km</td>
      <td>${t.finalLength} km</td>
      <td>${t.initialElevation} m</td>
      <td>${t.finalElevation} m</td>
    `,this.tbody.appendChild(l),this.updateSummary(e)}reset(){this.tbody.innerHTML="",this.updateSummary({getTotalDistance:()=>0,getTotalDesnivel:()=>0,getAverageSlope:()=>0})}updateSummary(e){this.querySelector(".total-dist").textContent=e.getTotalDistance().toFixed(2)+" m",this.querySelector(".total-desn").textContent=e.getTotalDesnivel().toFixed(2)+" m",this.querySelector(".avg-slope").textContent=(e.getAverageSlope()*100).toFixed(2)+" %"}}customElements.define("slope-result",b);class y extends HTMLElement{constructor(){super(...arguments);o(this,"analytics",new g);o(this,"result");o(this,"formEl");o(this,"segmentHandler",e=>this.onSegment(e));o(this,"clearAllHandler",()=>this.onClearAll())}async connectedCallback(){const e=await h.fetchUrl("/calculator.html");this.innerHTML=e;const s=this.querySelector(".top-section"),t=this.querySelector(".bottom-section");!s||!t||(this.result=document.createElement("slope-result"),t.appendChild(this.result),this.result.init(),this.formEl=document.createElement("slope-form"),this.formEl.addEventListener("segment-submitted",this.segmentHandler),this.formEl.addEventListener("clear-all",this.clearAllHandler),s.appendChild(this.formEl))}disconnectedCallback(){this.formEl&&(this.formEl.removeEventListener("segment-submitted",this.segmentHandler),this.formEl.removeEventListener("clear-all",this.clearAllHandler))}onSegment(e){const{detail:s}=e;this.analytics.addSegment(s),this.result.addSegment(this.analytics)}onClearAll(){this.analytics.clearSegments(),this.result.reset()}}customElements.define("slope-calculator",y);class m extends HTMLElement{constructor(){super();o(this,"_input");o(this,"_validator");const e=this.attachShadow({mode:"open"}),s=document.createElement("style");s.textContent=`
      input {
        width: 100%;
        box-sizing: border-box;
        padding: 8px 16px;
        font-size: 1rem;
        border: 1px solid #ccc;
        border-radius: 0.4rem;
        outline: none;
        transition: border-color .2s;
      }
      input:focus {
        border-color: #888;
      }
    `,this._input=document.createElement("input"),e.append(s,this._input)}static get observedAttributes(){return["type","placeholder","value","required"]}attributeChangedCallback(e,s,t){switch(e){case"type":this._input.type=t??"text";break;case"placeholder":this._input.placeholder=t??"";break;case"value":this._input.value=t??"";break;case"required":this._input.required=t!==null;break}}connectedCallback(){for(const e of m.observedAttributes)if(this.hasAttribute(e)){const s=this.getAttribute(e);this.attributeChangedCallback(e,null,s)}}get value(){return this._input.value}set value(e){this._input.value=e,this.setAttribute("value",e)}set validator(e){this._validator=e}get validator(){return this._validator}validate(){let e={valid:!0};return this._validator?e=this._validator(this.value)||{valid:!0}:e.valid=this._input.checkValidity(),this._input.style.borderColor=e.valid?"#ccc":"red",e.valid}}customElements.define("custom-input",m);document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("app");if(n){const r=document.createElement("slope-calculator");n.appendChild(r)}});
